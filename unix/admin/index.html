<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Admin - Programming and Software Notes</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Admin";
        var mkdocs_page_input_path = "unix/admin.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Programming and Software Notes
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Documentation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../documentation/mkdocs/">MkDocs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../documentation/sphinx/">Sphinx</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../documentation/doxygen/">Doxygen</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../documentation/latex/">LaTeX</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">GMT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../gmt/gmt5/">GMT5</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../gmt/gmt6/">GMT6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../gmt/pygmt/">pyGMT</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Seismology</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../seismology/data_requests/">Data requests</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../seismology/seisan/">SEISAN</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../seismology/obspy/">ObsPy</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Programming</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../programming/cuda/">CUDA</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tools</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/docker/">Docker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/cmake/">CMake</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/git/">Git</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/parallel/">Parallel</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/tmux/">tmux</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/vim/">vim</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Unix</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Admin</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#ssh-keys">SSH keys</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#problems-mounting-nfs-filesystems">Problems mounting NFS filesystems</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#add-locales">Add LOCALEs</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#disable-suspend-and-hibernation">Disable suspend and hibernation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#mysql">MySQL</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#mount-exfat-volumes-in-ubuntu-linux">Mount exFAT volumes in Ubuntu Linux</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#better-linux-tools-for-sysadmin">Better Linux tools for sysadmin</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#update-gcc">Update GCC</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../commands/">Commands</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dotfiles/">Dotfiles</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">macOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../macos/sonoma/">Sonoma installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../macos/ventura/">Ventura installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../macos/macports/">MacPorts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../macos/python/">Python installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../macos/tips/">Tips</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../macos/installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../macos/admin/">Admin</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Programming and Software Notes</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Unix &raquo;</li><li>Admin</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="admin">Admin</h1>
<p>When a disk is not responsing properly (usually an unavailable NFS file),
the <code>df</code> commands usually stalls. To find the filesystems that are not 
responding:</p>
<pre><code>$ strace /bin/df
</code></pre>
<p>Umount a non-responsive NFS file system:</p>
<pre><code>$ sudo umount -f -l /filesystem
</code></pre>
<p>Ubuntu commands for creating and deleting users</p>
<pre><code>$ sudo addgroup --gid 1001 seismo
$ sudo addgroup --gid 3850 sismi

$ sudo adduser --uid 3801 --ingroup sismi --shell /bin/tcsh jdiaz
$ sudo adduser --uid 3807 --ingroup sismi mario (bash shell)

$ sudo adduser --home /data9/INPUT input (non-standard home directory)
</code></pre>
<p>Remove an user and all its files (Ubuntu)</p>
<pre><code>$ sudo deluser --remove-all-files user &amp; (can take some time, so better send to background)
</code></pre>
<p>Get IPs and MAC addresses in a local network</p>
<pre><code>$ ifconfig | grep broadcast | arp -a
</code></pre>
<h2 id="ssh-keys">SSH keys</h2>
<p>Install a public key to login remotely</p>
<pre><code class="language-console">$ ssh-keygen -b 4096 -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/Users/antonio/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /Users/antonio/.ssh/id_rsa.
Your public key has been saved in /Users/antonio/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:Lfbjv4MWIq0MRc7nkL8KYcIGLiEEYyfuTD3NuzkV9Uk antonio@passavol2.cmima.csic.es
The key's randomart image is:
+---[RSA 4096]----+
|++ .     . E     |
|+.+ o . . o .    |
|+o o * o   o     |
|*+  . B o.       |
|.++ oo BS .      |
|.. o..=.=o.      |
|    .* o ooo     |
|     .+ ..o..    |
|      .. ...oo   |
+----[SHA256]-----+
</code></pre>
<pre><code class="language-console">$ ssh-copy-id antonio@edge3.ictja.csic.es
/opt/local/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &quot;/Users/antonio/.ssh/id_rsa.pub&quot;
The authenticity of host 'edge3.ictja.csic.es (193.144.102.105)' can't be established.
ECDSA key fingerprint is SHA256:eMm9bMReccDbOesNDlt9Lf6VMYuv1XlccefWC8zynaA.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
/opt/local/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/opt/local/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
antonio@edge3.ictja.csic.es's password:

Number of key(s) added:        1

Now try logging into the machine, with:   &quot;ssh 'antonio@edge3.ictja.csic.es'&quot;
and check to make sure that only the key(s) you wanted were added.
</code></pre>
<h2 id="problems-mounting-nfs-filesystems">Problems mounting NFS filesystems</h2>
<p>In some new systems when adding NFS filesystemes to <code>/etc/fstab</code> you can have some problems.</p>
<p>First that the system is still using the old <code>/etc/fstab</code>. To refresh:</p>
<pre><code>$ sudo systemctl daemon-reload
</code></pre>
<p>It is also possible that you need to install the package to handle NFS filesystems:</p>
<pre><code>$ sudo apt install nfs-common
</code></pre>
<h2 id="add-locales">Add LOCALEs</h2>
<p>In some new systems sometimes we can get this error when trying to change the LOCALE:</p>
<pre><code>$ export LC_ALL=en_US.UTF-8
-bash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8)
</code></pre>
<p>This is probably because the intended LOCALE is not installed. To install a LOCALE:</p>
<pre><code>$ locale -a
$ sudo locale-gen en_US.UTF-8
$ sudo update-locale
</code></pre>
<p>Another alternative (not tested):</p>
<pre><code>$ sudo apt-get install language-pack-ES
</code></pre>
<h2 id="disable-suspend-and-hibernation">Disable suspend and hibernation</h2>
<p>Instructions in this <a href="https://www.tecmint.com/disable-suspend-and-hibernation-in-linux/">link</a>.</p>
<pre><code>$ sudo systemctl mask sleep.target suspend.target hibernate.target hybrid-sleep.target

Created symlink /etc/systemd/system/sleep.target → /dev/null.
Created symlink /etc/systemd/system/suspend.target → /dev/null.
Created symlink /etc/systemd/system/hibernate.target → /dev/null.
Created symlink /etc/systemd/system/hybrid-sleep.target → /dev/null.
</code></pre>
<p>Verify changes:</p>
<pre><code>$ sudo systemctl status sleep.target suspend.target hibernate.target hybrid-sleep.target
</code></pre>
<p>and reboot (or $ sudo systemctl restart systemd-logind.service)</p>
<p>Re-enable suspend and hibernation:</p>
<pre><code>$ sudo systemctl unmask sleep.target suspend.target hibernate.target hybrid-sleep.target

Removed /etc/systemd/system/sleep.target.
Removed /etc/systemd/system/suspend.target.
Removed /etc/systemd/system/hibernate.target.
Removed /etc/systemd/system/hybrid-sleep.target.
</code></pre>
<p>Verify:</p>
<pre><code>$ sudo systemctl status sleep.target suspend.target hibernate.target hybrid-sleep.target
</code></pre>
<h2 id="mysql">MySQL</h2>
<p>Install MySQL from command line (not tested)</p>
<pre><code>$ sudo apt-get -y install mysql-server mysql-client
$ sudo mysql_secure_installation
</code></pre>
<p>(Probably this does not install "dev" package with include and libraries for MySQL)</p>
<p>Setup password for mysql root</p>
<pre><code>ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'root_password';
</code></pre>
<h2 id="mount-exfat-volumes-in-ubuntu-linux">Mount exFAT volumes in Ubuntu Linux</h2>
<p>Ubuntu by default is not able to mount disks formatted in exFAT</p>
<pre><code>$ sudo apt-get install exfat-fuse exfat-utils
</code></pre>
<h2 id="better-linux-tools-for-sysadmin">Better Linux tools for sysadmin</h2>
<pre><code>htop/atop &gt; top
ss &gt; netstat
ip &gt; ifconfig
dig &gt; nslookup
mtr &gt; ping+traceroute
collectl &gt; sar
</code></pre>
<h2 id="update-gcc">Update GCC</h2>
<p>Default version of gcc/g++ in xlr8 (Ubuntu 14.04 LTS) is 5.4.0</p>
<p>Need at least version 7 to compile Mirmex</p>
<p>To fix some problems with corrupted packages:</p>
<pre><code>$ sudo rm -vf /var/lib/apt/lists/*
$ sudo apt-get update
</code></pre>
<p>(still gives an error about Google Earth, but the rest seems to work fine)</p>
<pre><code class="language-console">$ sudo add-apt-repository ppa:ubuntu-toolchain-r/test

$ sudo apt-get update

$ sudo apt install gcc-7 g++-7

$ sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-7 70 \
 --slave /usr/bin/g++ g++ /usr/bin/g++-7 \
 --slave /usr/bin/gcov gcov /usr/bin/gcov-7
</code></pre>
<p>(Modified from this <a href="https://linuxize.com/post/how-to-install-gcc-compiler-on-ubuntu-18-04/">link</a>):</p>
<pre><code class="language-console">sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-9 90 --slave /usr/bin/g++ g++ /usr/bin/g++-9 --slave /usr/bin/gcov gcov /usr/bin/gcov-9
</code></pre>
<p>WARNING!!!: gfortran not updated to version 7!!!</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../tools/vim/" class="btn btn-neutral float-left" title="vim"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../commands/" class="btn btn-neutral float-right" title="Commands">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../tools/vim/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../commands/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
